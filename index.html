<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>è¿·è·¯æ•‘æ´å®šä½ç³»çµ± / è¿·å­æ•‘æ´ä½ç½®ç¢ºèªã‚·ã‚¹ãƒ†ãƒ </title>
  <style>
    body{font-family:"Noto Sans TC",system-ui,Segoe UI,Roboto,Arial; background: linear-gradient(180deg,#cdeac0 0%,#a8d5ba 100%); margin:0; color:#2f3e46; min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start;}
    header{padding-top:28px; text-align:center;}
    .logo{width:70px;height:70px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #74c69d, #2d6a4f);display:inline-flex;align-items:center;justify-content:center;box-shadow:0 2px 6px rgba(0,0,0,0.2);margin-bottom:8px;}
    .logo::before{content:"ğŸ§­";font-size:2rem;color:#fff;}
    h1{margin:6px 0;font-size:1.6rem;}
    p.description{margin:0 20px;line-height:1.6;font-size:1rem;}
    main{width:100%;max-width:420px;padding:20px;box-sizing:border-box;}
    button{display:block;width:100%;padding:16px 18px;margin:12px 0;border:none;border-radius:999px;background:linear-gradient(90deg,#52b788,#40916c);color:#fff;font-size:18px;cursor:pointer;box-shadow:0 3px 6px rgba(0,0,0,0.12);}
    button:active{transform:translateY(1px);}
    #mapLink{margin-top:10px;word-break:break-word;font-weight:600;color:#123e2b;font-size:1rem;}
    .note{font-size:0.95rem;color:#2f3e46;margin-top:10px;}
    .step{background:rgba(255,255,255,0.6);padding:8px 12px;border-radius:12px;margin-bottom:6px;font-weight:600;}
    footer{font-size:0.85rem;padding:12px 8px;color:#495057;text-align:center;}
    a.button-link{text-decoration:none;}
    /* æ‹’çµ•å¾Œæ•™å­¸æç¤º */
    #permission-popup {
      display:none;
      text-align:left;
      padding:20px;
      margin:20px auto;
      background:rgba(255,255,255,0.95);
      border-radius:12px;
      box-shadow:0 4px 10px rgba(0,0,0,0.15);
      max-width:400px;
      font-size:16px;
      line-height:1.5;
    }
    #permission-popup h2 {font-size:18px; font-weight:600; margin-bottom:12px;}
    #permission-popup ol {padding-left:20px; margin:0;}
    #permission-popup button {margin-top:12px;}
  </style>
</head>
<body>
  <header>
    <div class="logo"></div>
    <h1>ğŸ§­ è¿·è·¯æ•‘æ´å®šä½ç³»çµ± / è¿·å­æ•‘æ´ä½ç½®ç¢ºèªã‚·ã‚¹ãƒ†ãƒ </h1>
    <p class="description">
      è‹¥ä½ èˆ‡éšŠä¼èµ°æ•£ï¼Œè«‹ä¾åºæ“ä½œï¼šå–å¾—ä½ çš„ä½ç½®ä¸¦ç™¼é€çµ¦é ˜éšŠã€‚<br>
      ã‚‚ã—éšŠä¼ã¨ã¯ãã‚ŒãŸå ´åˆã¯ã€é †ç•ªã«æ“ä½œã—ã¦ãã ã•ã„ï¼šç¾åœ¨åœ°ã‚’å–å¾—ã—ã¦ãƒªãƒ¼ãƒ€ãƒ¼ã«é€ä¿¡ã€‚<br><br>
      ğŸ“ è³‡æ–™åƒ…ç”¨æ–¼å³æ™‚å®šä½ï¼Œä¸æœƒè¢«å„²å­˜ã€‚<br>
      ğŸ“ ãƒ‡ãƒ¼ã‚¿ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ä½ç½®ç¢ºèªã®ã¿ä½¿ç”¨ã•ã‚Œã€ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚
    </p>
  </header>

  <main>
    <div class="step">æ­¥é©Ÿ1ï¼šå–å¾—ä½ çš„ç¾åœ¨ä½ç½® / ã‚¹ãƒ†ãƒƒãƒ—1ï¼šç¾åœ¨åœ°ã‚’å–å¾—</div>
    <button id="getBtn">ğŸ“ å–å¾—ç›®å‰ä½ç½® / ç¾åœ¨åœ°å–å¾—</button>

    <div id="mapLink"></div>

    <div id="actions" style="display:none;">
      <div class="step">æ­¥é©Ÿ2ï¼šç™¼é€ä½ çš„ç¾åœ¨ä½ç½®çµ¦é ˜éšŠ / ã‚¹ãƒ†ãƒƒãƒ—2ï¼šç¾åœ¨åœ°ã‚’ãƒªãƒ¼ãƒ€ãƒ¼ã«é€ä¿¡</div>
      <button id="sendLineBtn">ğŸ’¬ ç™¼é€ç¾åœ¨ä½ç½® / ç¾åœ¨åœ°ã‚’é€ä¿¡</button>
      <button id="copyBtn">ğŸ“‹ è¤‡è£½å®šä½é€£çµ / ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</button>
      <p class="note">
        è‹¥è‡ªå‹•å‚³é€å¤±æ•—ï¼Œå¯æ‰‹å‹•è¤‡è£½é€£çµæˆ–æˆªåœ–é é¢å‚³çµ¦é ˜éšŠã€‚<br>
        è‡ªå‹•é€ä¿¡ã«å¤±æ•—ã—ãŸå ´åˆã¯ã€æ‰‹å‹•ã§ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‹ã€ç”»é¢ã‚’ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã—ã¦ãƒªãƒ¼ãƒ€ãƒ¼ã«é€ä¿¡ã—ã¦ãã ã•ã„ã€‚
      </p>
    </div>

    <!-- æ‹’çµ•å¾Œæ•™å­¸å½ˆçª— -->
    <div id="permission-popup">
      <h2>âš ï¸ å°šæœªå…è¨±å®šä½ / ä½ç½®æƒ…å ±ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“</h2>
      <p>è«‹ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿæ‰‹å‹•é–‹å•Ÿå®šä½æ¬Šé™ï¼š<br>ä»¥ä¸‹ã®æ‰‹é †ã§æ‰‹å‹•ã§ä½ç½®æƒ…å ±ã‚’è¨±å¯ã—ã¦ãã ã•ã„ï¼š</p>
      <ol>
        <li>Androidï¼šè¨­å®š â†’ æ‡‰ç”¨ç¨‹å¼ â†’ æ‚¨ä½¿ç”¨çš„ç€è¦½å™¨ â†’ æ¬Šé™ â†’ ä½ç½®<br>
            Androidã®å ´åˆï¼šè¨­å®š â†’ ã‚¢ãƒ—ãƒª â†’ ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ â†’ æ¨©é™ â†’ ä½ç½®æƒ…å ±</li>
        <li>iOSï¼šè¨­å®š â†’ Safari â†’ ç¶²ç«™è¨­å®š â†’ ä½ç½®<br>
            iOSã®å ´åˆï¼šè¨­å®š â†’ Safari â†’ ã‚µã‚¤ãƒˆè¨­å®š â†’ ä½ç½®æƒ…å ±</li>
        <li>å®Œæˆå¾Œï¼Œå›åˆ°æ­¤é é¢é‡æ–°æŒ‰ã€Œå–å¾—ç›®å‰ä½ç½®ã€<br>
            å®Œäº†å¾Œã€ã“ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã£ã¦ã€Œç¾åœ¨åœ°å–å¾—ã€ã‚’å†åº¦æŠ¼ã—ã¦ãã ã•ã„</li>
      </ol>
      <button id="closePopupBtn">æˆ‘çŸ¥é“äº† / ã‚ã‹ã‚Šã¾ã—ãŸ</button>
    </div>
  </main>

  <footer>
    ç”±é ˜éšŠæé•·ç´˜è£½ä½œ | Powered by Netlify
  </footer>

  <script>
    let mapUrl = "";
    const getBtn = document.getElementById('getBtn');
    const sendLineBtn = document.getElementById('sendLineBtn');
    const copyBtn = document.getElementById('copyBtn');
    const actions = document.getElementById('actions');
    const mapLinkDiv = document.getElementById('mapLink');

    const popup = document.getElementById('permission-popup');
    const closePopupBtn = document.getElementById('closePopupBtn');

    getBtn.addEventListener('click', () => {
      if (!navigator.geolocation) {
        alert('æ­¤è£ç½®ä¸æ”¯æ´å®šä½åŠŸèƒ½ / ã“ã®ç«¯æœ«ã¯ä½ç½®æƒ…å ±ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚');
        return;
      }
      getBtn.disabled = true;
      getBtn.textContent = 'â³ å–å¾—ä½ç½®ä¸­... / ä½ç½®æƒ…å ±å–å¾—ä¸­...';
      navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude.toFixed(6);
        const lon = pos.coords.longitude.toFixed(6);
        mapUrl = `https://maps.google.com/?q=${lat},${lon}`;
        mapLinkDiv.innerHTML = `âœ… å®šä½æˆåŠŸ / ä½ç½®å–å¾—æˆåŠŸï¼š<br><a href="${mapUrl}" target="_blank" rel="noopener">${mapUrl}</a>`;
        actions.style.display = 'block';
        getBtn.disabled = false;
        getBtn.textContent = 'ğŸ“ å–å¾—ç›®å‰ä½ç½® / ç¾åœ¨åœ°å–å¾—';
        actions.scrollIntoView({behavior:'smooth', block:'center'});
        popup.style.display = 'none';
      }, err => {
        getBtn.disabled = false;
        getBtn.textContent = 'ğŸ“ å–å¾—ç›®å‰ä½ç½® / ç¾åœ¨åœ°å–å¾—';
        if (err.code === err.PERMISSION_DENIED) {
          // æ‹’çµ• â†’ é¡¯ç¤ºæ•™å­¸å½ˆçª—
          popup.style.display = 'block';
        } else if (err.code === err.POSITION_UNAVAILABLE) {
          alert('âš ï¸ ç„¡æ³•å–å¾—å®šä½è³‡è¨Š / ä½ç½®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã€‚');
        } else if (err.code === err.TIMEOUT) {
          alert('âš ï¸ å®šä½é€¾æ™‚ï¼Œè«‹å†è©¦ä¸€æ¬¡ / ä½ç½®æƒ…å ±å–å¾—ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
        } else {
          alert('âš ï¸ ç™¼ç”ŸéŒ¯èª¤ï¼š' + err.message + ' / ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š' + err.message);
        }
      }, {enableHighAccuracy:true, timeout:15000, maximumAge:0});
    });

    sendLineBtn.addEventListener('click', () => {
      if (!mapUrl) return alert('è«‹å…ˆå–å¾—ä½ç½® / å…ˆã«ç¾åœ¨åœ°ã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚');
      const message = encodeURIComponent(`æˆ‘ç¾åœ¨çš„ä½ç½®ï¼š${mapUrl} / ç¾åœ¨åœ°ï¼š${mapUrl}`);
      const composeUrl = `https://line.me/R/msg/text/?${message}`;
      window.open(composeUrl, '_blank');
    });

    copyBtn.addEventListener('click', () => {
      if (!mapUrl) return alert('è«‹å…ˆå–å¾—ä½ç½® / å…ˆã«ç¾åœ¨åœ°ã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚');
      navigator.clipboard.writeText(mapUrl).then(() => {
        alert('ğŸ“‹ å·²è¤‡è£½å®šä½é€£çµï¼Œå¯è²¼ä¸Šå‚³é€çµ¦é ˜éšŠ / ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€ãƒªãƒ¼ãƒ€ãƒ¼ã«é€ä¿¡ã§ãã¾ã™ã€‚');
      }).catch(() => {
        alert('âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹é•·æŒ‰é€£çµæ‰‹å‹•è¤‡è£½ / ã‚³ãƒ”ãƒ¼å¤±æ•—ã€ãƒªãƒ³ã‚¯ã‚’é•·æŠ¼ã—ã—ã¦æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
      });
    });

    closePopupBtn.addEventListener('click', () => {
      popup.style.display = 'none';
    });
  </script>
</body>
</html>
